% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mc.R
\name{mc_integrate}
\alias{mc_integrate}
\title{Monte Carlo integration with variance reduction}
\usage{
mc_integrate(
  g,
  sampler,
  n,
  method = c("plain", "antithetic", "control", "importance", "stratified"),
  control = list()
)
}
\arguments{
\item{g}{Function \code{g(x)} to be averaged.}

\item{sampler}{Function to draw samples. For methods \code{"plain"},
\code{"antithetic"} and \code{"control"}, this should generate
\code{n} samples from the target distribution.}

\item{n}{Integer, number of samples.}

\item{method}{One of \code{"plain"}, \code{"antithetic"},
\code{"control"}, \code{"importance"}, or \code{"stratified"}.}

\item{control}{List of method-specific options; see Details.}
}
\value{
A list with components \code{theta_hat} (estimate) and
\code{se_hat} (Monte Carlo standard error).
}
\description{
Estimate \eqn{\theta = E[g(X)]} using Monte Carlo with optional variance
reduction: antithetic variables, control variates, importance sampling,
or stratified sampling.
}
\details{
For \code{method = "control"}, supply \code{control$h} (control variate
function) and \code{control$mu_h} (known mean of \code{h(X)}).

For \code{method = "importance"}, supply \code{control$sampler_q} to
draw samples from \eqn{q}, and \code{control$w} a function returning
the importance weight \eqn{f(x) / q(x)}.

For \code{method = "stratified"}, \code{sampler} should accept an
argument \code{stratum} indicating which stratum to sample from, and
\code{control$strata} should give a vector of stratum labels and
\code{control$n_strata} a vector of sample sizes per stratum.
}
